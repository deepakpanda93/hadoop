{"paragraphs":[{"title":"Socket Stream Receiver","text":"import org.apache.spark._\nimport org.apache.spark.streaming._\nimport org.apache.spark.streaming.StreamingContext._\n\nval conf =  new SparkConf().setMaster(\"local[2]\").set(\"spark.driver.allowMultipleContexts\", \"true\").setAppName(\"NetworkWordCount\")\nval ssc = new StreamingContext(conf, Seconds(1))\nval lines = ssc.socketTextStream(\"localhost\", 9999)\nval words = lines.flatMap(_.split(\" \"))\nval pairs = words.map(word => (word, 1))\nval wordCounts = pairs.reduceByKey(_+_)\nwordCounts.print()\nssc.start()\nssc.awaitTermination()","dateUpdated":"2017-01-26T01:36:13-0700","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485389656869_-791159755","id":"20170125-171416_363454590","dateCreated":"2017-01-25T05:14:16-0700","dateStarted":"2017-01-26T11:48:56-0700","dateFinished":"2017-01-26T11:48:36-0700","status":"ABORT","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4938"},{"title":"Twitter Stream Receiver","text":"import org.apache.spark.SparkConf\nimport org.apache.spark.streaming.twitter.TwitterUtils\nimport org.apache.spark.streaming.{Seconds, StreamingContext}    \n    \n    var args = Array(\"Zara\", \"Nuha\", \"Ayan\", \"v\")\n    val Array(consumerKey, consumerSecret, accessToken,  accessTokenSecret ) = args.take(4)\n    val filters = args.takeRight(args.length - 4)\n    System.setProperty(\"twitter4j.oauth.consumerKey\", consumerKey)\n    System.setProperty(\"twitter4j.oauth.consumerSecret\", consumerSecret)\n    System.setProperty(\"twitter4j.oauth.accessToken\", accessToken)\n    System.setProperty(\"twitter4j.oauth.accessTokenSecret\", accessTokenSecret)\n    val sparkConf = new SparkConf().set(\"spark.driver.allowMultipleContexts\", \"true\").setAppName(\"TwitterPopularTags\")\n    val ssc = new StreamingContext(sparkConf, Seconds(2))\n    val stream = TwitterUtils.createStream(ssc, None, filters)\n    val hashTags = stream.flatMap(status => status.getText.split(\" \").filter(_.startsWith(\"#\")))\n\n    val topCounts60 = hashTags.map((_, 1)).reduceByKeyAndWindow(_ + _, Seconds(60))\n      .map{case (topic, count) => (count, topic)}\n      .transform(_.sortByKey(false))\n\n    val topCounts10 = hashTags.map((_, 1)).reduceByKeyAndWindow(_ + _, Seconds(10))\n      .map{case (topic, count) => (count, topic)}\n      .transform(_.sortByKey(false))\n\n    // Print popular hashtags\n    topCounts60.foreachRDD(rdd => {\n      val topList = rdd.take(10)\n      println(\"\\nPopular topics in last 60 seconds (%s total):\".format(rdd.count()))\n      topList.foreach{case (count, tag) => println(\"%s (%s tweets)\".format(tag, count))}\n    })\n\n    topCounts10.foreachRDD(rdd => {\n      val topList = rdd.take(10)\n      println(\"\\nPopular topics in last 10 seconds (%s total):\".format(rdd.count()))\n      topList.foreach{case (count, tag) => println(\"%s (%s tweets)\".format(tag, count))}\n    })\n\n    ssc.start()\n    ssc.awaitTermination()","dateUpdated":"2017-01-26T02:30:52-0700","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485390003801_-126268804","id":"20170125-172003_1550774963","result":{"code":"ERROR","type":"TEXT","msg":"\nimport org.apache.spark.SparkConf\n\n\n\n<console>:28: error: object twitter is not a member of package org.apache.spark.streaming\n         import org.apache.spark.streaming.twitter.TwitterUtils\n                                           ^\n"},"dateCreated":"2017-01-25T05:20:03-0700","dateStarted":"2017-01-26T02:30:52-0700","dateFinished":"2017-01-26T02:30:52-0700","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:4939"},{"text":"","dateUpdated":"2017-01-26T11:49:25-0700","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485456555452_512788663","id":"20170126-114915_2012553170","dateCreated":"2017-01-26T11:49:15-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4940"}],"name":"Streaming Spark","id":"2C6VVSMKR","angularObjects":{"2C8M5ZUP9:shared_process":[],"2C6X1XPW2:shared_process":[],"2C5BM56KU:shared_process":[],"2C71S63FU:shared_process":[],"2C6AFXU2C:shared_process":[],"2C5XSEPC9:shared_process":[],"2C75T3XPF:shared_process":[],"2C8N1PPUZ:shared_process":[],"2C6ABYCK9:shared_process":[],"2C7MAYGQ7:shared_process":[],"2C8FH41ZP:shared_process":[],"2C6SJGDQC:shared_process":[],"2C6J6DSY4:shared_process":[],"2C7EABZN1:shared_process":[],"2C7R8UJ38:shared_process":[],"2C5UNX7GJ:shared_process":[],"2C8XH9MQ6:shared_process":[],"2C6RC675F:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}