{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486504434311_115571552","id":"20170207-145354_1412413781","dateCreated":"2017-02-07T14:53:54-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:221","text":"import sqlContext.implicits._\nimport org.apache.spark.SparkContext._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\n\nval sqlContext1 = new org.apache.spark.sql.SQLContext(sc)\n\nval sqlContext = sqlc\n\n//1. load data and create spark data frame \nval bankText = sc.textFile(\"../files/bank-full.csv\")\nval bank = bankText.map(x => x.split(\";\"))\nval bank_f = bank.filter(s => s(0) != \"\\\"age\\\"\")\n\ncase class BankRecord(age:Int, job:String, marital:String, education:String, default:Boolean, balance:Int, housing:Boolean, loan:Boolean, contact:String, day:Int, month:String,\n    duration:String, campaign:String, pdays:String, previous:String, pOutcome:String, output:Boolean)\n\ndef toBoolean(x: String) = x match {\n      case \"yes\" => true\n      case \"no\" => false\n      case _ => false\n    }\n\nval bankDF = bank_f.map(\n        x => BankRecord ( x(0).toInt, \n                    x(1).replaceAll(\"\\\"\",\"\"),\n                    x(2).replaceAll(\"\\\"\",\"\"),\n                    x(3).replaceAll(\"\\\"\",\"\"),\n                    toBoolean(x(4).replaceAll(\"\\\"\",\"\")),\n                    x(5).replaceAll(\"\\\"\",\"\").toInt,\n                    toBoolean(x(6).replaceAll(\"\\\"\",\"\")),\n                    toBoolean(x(7).replaceAll(\"\\\"\",\"\")),\n                    x(8).replaceAll(\"\\\"\",\"\"),\n                    x(9).replaceAll(\"\\\"\",\"\").toInt,\n                    x(10).replaceAll(\"\\\"\",\"\"),\n                    x(11).replaceAll(\"\\\"\",\"\"),\n                    x(12).replaceAll(\"\\\"\",\"\"),\n                    x(13).replaceAll(\"\\\"\",\"\"),\n                    x(14).replaceAll(\"\\\"\",\"\"),\n                    x(15).replaceAll(\"\\\"\",\"\"),\n                    toBoolean(x(16).replaceAll(\"\\\"\",\"\"))\n        )\n    ).toDF()\nbankDF.show()\nbankDF.registerTempTable(\"bank\")\n\n//2. Give marketing success rate. (No. of people subscribed / total no. of entries)\nval totalPeople = bankDF.count();\nval successPeople = bankDF.filter(bankDF(\"output\")).count()\nval successRate =  (successPeople.toDouble/totalPeople.toDouble) * 100 ;\n\n\n\n","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:30-0700","dateStarted":"2017-02-07T16:21:14-0700","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport sqlContext.implicits._\n\nimport org.apache.spark.SparkContext._\n\nimport org.apache.spark.sql._\n\nimport org.apache.spark.sql.types._\n\nsqlContext1: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@488a1e0b\n\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.hive.HiveContext@27ec01c7\n\nbankText: org.apache.spark.rdd.RDD[String] = ../files/bank-full.csv MapPartitionsRDD[839] at textFile at <console>:230\n\nbank: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[840] at map at <console>:232\n\nbank_f: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[841] at filter at <console>:234\n\ndefined class BankRecord\n\ntoBoolean: (x: String)Boolean\n\nbankDF: org.apache.spark.sql.DataFrame = [age: int, job: string, marital: string, education: string, default: boolean, balance: int, housing: boolean, loan: boolean, contact: string, day: int, month: string, duration: string, campaign: string, pdays: string, previous: string, pOutcome: string, output: boolean]\n+---+------------+--------+---------+-------+-------+-------+-----+-------+---+-----+--------+--------+-----+--------+--------+------+\n|age|         job| marital|education|default|balance|housing| loan|contact|day|month|duration|campaign|pdays|previous|pOutcome|output|\n+---+------------+--------+---------+-------+-------+-------+-----+-------+---+-----+--------+--------+-----+--------+--------+------+\n| 58|  management| married| tertiary|  false|   2143|   true|false|unknown|  5|  may|     261|       1|   -1|       0| unknown| false|\n| 44|  technician|  single|secondary|  false|     29|   true|false|unknown|  5|  may|     151|       1|   -1|       0| unknown| false|\n| 33|entrepreneur| married|secondary|  false|      2|   true| true|unknown|  5|  may|      76|       1|   -1|       0| unknown| false|\n| 47| blue-collar| married|  unknown|  false|   1506|   true|false|unknown|  5|  may|      92|       1|   -1|       0| unknown| false|\n| 33|     unknown|  single|  unknown|  false|      1|  false|false|unknown|  5|  may|     198|       1|   -1|       0| unknown| false|\n| 35|  management| married| tertiary|  false|    231|   true|false|unknown|  5|  may|     139|       1|   -1|       0| unknown| false|\n| 28|  management|  single| tertiary|  false|    447|   true| true|unknown|  5|  may|     217|       1|   -1|       0| unknown| false|\n| 42|entrepreneur|divorced| tertiary|   true|      2|   true|false|unknown|  5|  may|     380|       1|   -1|       0| unknown| false|\n| 58|     retired| married|  primary|  false|    121|   true|false|unknown|  5|  may|      50|       1|   -1|       0| unknown| false|\n| 43|  technician|  single|secondary|  false|    593|   true|false|unknown|  5|  may|      55|       1|   -1|       0| unknown| false|\n| 41|      admin.|divorced|secondary|  false|    270|   true|false|unknown|  5|  may|     222|       1|   -1|       0| unknown| false|\n| 29|      admin.|  single|secondary|  false|    390|   true|false|unknown|  5|  may|     137|       1|   -1|       0| unknown| false|\n| 53|  technician| married|secondary|  false|      6|   true|false|unknown|  5|  may|     517|       1|   -1|       0| unknown| false|\n| 58|  technician| married|  unknown|  false|     71|   true|false|unknown|  5|  may|      71|       1|   -1|       0| unknown| false|\n| 57|    services| married|secondary|  false|    162|   true|false|unknown|  5|  may|     174|       1|   -1|       0| unknown| false|\n| 51|     retired| married|  primary|  false|    229|   true|false|unknown|  5|  may|     353|       1|   -1|       0| unknown| false|\n| 45|      admin.|  single|  unknown|  false|     13|   true|false|unknown|  5|  may|      98|       1|   -1|       0| unknown| false|\n| 57| blue-collar| married|  primary|  false|     52|   true|false|unknown|  5|  may|      38|       1|   -1|       0| unknown| false|\n| 60|     retired| married|  primary|  false|     60|   true|false|unknown|  5|  may|     219|       1|   -1|       0| unknown| false|\n| 33|    services| married|secondary|  false|      0|   true|false|unknown|  5|  may|      54|       1|   -1|       0| unknown| false|\n+---+------------+--------+---------+-------+-------+-------+-----+-------+---+-----+--------+--------+-----+--------+--------+------+\nonly showing top 20 rows\n\n\ntotalPeople: Long = 45211\n\nsuccessPeople: Long = 5289\n\nsuccessRate: Double = 11.698480458295547\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486505308296_465950273","id":"20170207-150828_1541404282","dateCreated":"2017-02-07T15:08:28-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:386","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:34-0700","dateStarted":"2017-02-07T16:21:15-0700","result":{"code":"SUCCESS","type":"TEXT","msg":"+---+---+\n|_c0|_c1|\n+---+---+\n| 95| 18|\n+---+---+\n\n\nmaxAge: Unit = ()\n\nageColumn: org.apache.spark.sql.DataFrame = [age: int]\n+-------+-----------------+\n|summary|              age|\n+-------+-----------------+\n|  count|            45211|\n|   mean|40.93621021432837|\n| stddev|10.61876204097543|\n|    min|               18|\n|    max|               95|\n+-------+-----------------+\n\n+----+\n| _c0|\n+----+\n|39.0|\n+----+\n\n"},"text":"//3. Check max, min, Mean and median age of average targeted customer \nval maxAge = sqlContext.sql(\"select max(age) , min(age)  from bank\").show()\nval ageColumn = sqlContext.sql(\"select age from bank\")\nageColumn.describe().show()\nsqlContext.sql(\"select percentile(age, 0.50) from bank\").show"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486507101029_726199228","id":"20170207-153821_219601449","dateCreated":"2017-02-07T15:38:21-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:667","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:36-0700","dateStarted":"2017-02-07T16:21:30-0700","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+------------------+\n|summary|           balance|\n+-------+------------------+\n|  count|             45211|\n|   mean|1362.2720576850766|\n| stddev|3044.7658291685198|\n|    min|             -8019|\n|    max|            102127|\n+-------+------------------+\n\n+-----+\n|  _c0|\n+-----+\n|448.0|\n+-----+\n\n\n\nbalanceStatus: Unit = ()\nmedian: Unit = ()\n"},"text":"//4. Check quality of clients by checking average balance, median balance of clients \rval balanceStatus = sqlContext.sql(\"select balance from bank\").describe().show();\rval median = sqlContext.sql(\"select percentile(balance, 0.50) from bank\").show\r\r"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486508579399_-258306453","id":"20170207-160259_102725277","dateCreated":"2017-02-07T16:02:59-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:979","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:39-0700","dateStarted":"2017-02-07T16:21:34-0700","result":{"code":"SUCCESS","type":"TEXT","msg":"+------+------------------+\n|output|          avg(age)|\n+------+------------------+\n|  true|41.670069956513515|\n| false| 40.83898602274435|\n+------+------------------+\n\n"},"text":"//5. Check if age matters in marketing subscription for deposit \rbankDF.groupBy(\"output\").agg(avg($\"age\")).show"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486508892235_-1905155983","id":"20170207-160812_2109570611","dateCreated":"2017-02-07T16:08:12-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1188","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:41-0700","dateStarted":"2017-02-07T16:21:37-0700","result":{"code":"SUCCESS","type":"TEXT","msg":"+------+--------------+\n|output|count(marital)|\n+------+--------------+\n|  true|          5289|\n| false|         39922|\n+------+--------------+\n\n"},"text":"//6. Check if marital status mattered for subscription to deposit. \rbankDF.groupBy(\"output\").agg(count($\"marital\")).show"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486508996711_-939281358","id":"20170207-160956_1769139993","dateCreated":"2017-02-07T16:09:56-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1276","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:45-0700","dateStarted":"2017-02-07T16:21:39-0700","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------+---+------+-----+\n| marital|age|output|count|\n+--------+---+------+-----+\n|divorced| 64|  true|    4|\n|divorced| 37|  true|   15|\n|divorced| 64| false|    5|\n|divorced| 37| false|  155|\n|  single| 37|  true|   57|\n|  single| 37| false|  396|\n| married| 64|  true|   31|\n| married| 37|  true|   98|\n| married| 64| false|   34|\n| married| 37| false|  975|\n|divorced| 75|  true|    3|\n|divorced| 48|  true|   16|\n|divorced| 75| false|    9|\n|divorced| 48| false|  150|\n|  single| 48|  true|   15|\n|  single| 48| false|  109|\n|  single| 21|  true|   21|\n| married| 75|  true|   12|\n|  single| 21| false|   53|\n| married| 48|  true|   51|\n+--------+---+------+-----+\nonly showing top 20 rows\n\n+--------+------+-----+\n| marital|output|count|\n+--------+------+-----+\n|divorced|  true|  622|\n|divorced| false| 4585|\n|  single|  true| 1912|\n|  single| false|10878|\n| married|  true| 2755|\n| married| false|24459|\n+--------+------+-----+\n\n+---+------+-----+\n|age|output|count|\n+---+------+-----+\n| 58| false|  668|\n| 31|  true|  206|\n| 31| false| 1790|\n| 69|  true|   17|\n| 42|  true|  111|\n| 69| false|   27|\n| 42| false| 1131|\n| 80|  true|   12|\n| 53|  true|   85|\n| 80| false|   19|\n| 53| false|  806|\n| 26|  true|  134|\n| 26| false|  671|\n| 64|  true|   35|\n| 37|  true|  170|\n| 64| false|   39|\n| 37| false| 1526|\n| 75|  true|   15|\n| 48|  true|   82|\n| 75| false|   24|\n+---+------+-----+\nonly showing top 20 rows\n\n"},"text":"//7. Check if age and marital status together mattered for subscription to deposit scheme \rbankDF.groupBy(\"marital\",\"age\",\"output\").count.show();\rbankDF.groupBy(\"marital\",\"output\").count.show();\rbankDF.groupBy(\"age\",\"output\").count.show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486509106299_-1539554228","id":"20170207-161146_1697066087","dateCreated":"2017-02-07T16:11:46-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1366","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:48-0700","dateStarted":"2017-02-07T16:21:41-0700","result":{"code":"SUCCESS","type":"TEXT","msg":"+------------+------+-----+\n|age_category|output|count|\n+------------+------+-----+\n|       young|  true|  207|\n|       young| false|  602|\n|         old|  true|  502|\n|         old| false|  686|\n|     mid_age|  true| 4580|\n|     mid_age| false|38634|\n+------------+------+-----+\n\n\nbankAgeDF: org.apache.spark.sql.DataFrame = [age: int, job: string, marital: string, education: string, default: boolean, balance: int, housing: boolean, loan: boolean, contact: string, day: int, month: string, duration: string, campaign: string, pdays: string, previous: string, pOutcome: string, output: boolean, age_category: string]\n"},"text":"//8. Do Feature engineering for age column and find right age effect on campaign\rval bankAgeDF = bankDF.withColumn(\"age_category\", when($\"age\" < 25 , \"young\")\r        .otherwise( when($\"age\" > 60 , \"old\").otherwise(\"mid_age\")));\r\rbankAgeDF.groupBy(\"age_category\",\"output\").count.show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1486509371306_1437615792","id":"20170207-161611_2094701747","dateCreated":"2017-02-07T16:16:11-0700","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1502","dateUpdated":"2017-02-07T16:21:14-0700","dateFinished":"2017-02-07T16:21:48-0700","dateStarted":"2017-02-07T16:21:46-0700","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":""}],"name":"Spark Project","id":"2CANT5YS1","angularObjects":{"2C8M5ZUP9:shared_process":[],"2C6X1XPW2:shared_process":[],"2C5BM56KU:shared_process":[],"2C71S63FU:shared_process":[],"2C6AFXU2C:shared_process":[],"2C5XSEPC9:shared_process":[],"2C75T3XPF:shared_process":[],"2C8N1PPUZ:shared_process":[],"2C6ABYCK9:shared_process":[],"2C7MAYGQ7:shared_process":[],"2C8FH41ZP:shared_process":[],"2C6SJGDQC:shared_process":[],"2C6J6DSY4:shared_process":[],"2C7EABZN1:shared_process":[],"2C7R8UJ38:shared_process":[],"2C5UNX7GJ:shared_process":[],"2C8XH9MQ6:shared_process":[],"2C6RC675F:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}